<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Cyber Sleuth Challenge - Q10</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&amp;family=Montserrat:wght@400;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet"/>
<style>
    body {
        background-color: #121212;
        color: #e0e0e0;
        font-family: 'Montserrat', sans-serif;
        margin: 0;
        padding: 0;
        width: 1280px;
        min-height: 720px;
    }
    .container {
        width: 1280px;
        min-height: 720px;
        padding: 40px;
        box-sizing: border-box;
    }
    .header {
        border-bottom: 2px solid #2563eb;
        padding-bottom: 10px;
        margin-bottom: 30px;
    }
    .code-block {
        font-family: 'Roboto Mono', monospace;
        background-color: #1e1e1e;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
        border-left: 4px solid #2563eb;
        color: #e0e0e0;
    }
    .keyword { color: #569cd6; }
    .option {
        background-color: #1e293b;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 15px;
        border-left: 4px solid #3b82f6;
        transition: all 0.18s ease;
        cursor: pointer;
        user-select: none;
    }
    .option:hover { background-color: #2d3748; border-left: 4px solid #60a5fa; }
    .option.selected { background-color: #0f172a; border-left: 4px solid #93c5fd; box-shadow: 0 0 0 4px rgba(59,130,246,0.06) inset; }
    .option-letter {
        display: inline-block;
        width: 30px;
        height: 30px;
        background-color: #3b82f6;
        color: white;
        text-align: center;
        line-height: 30px;
        border-radius: 50%;
        margin-right: 10px;
        font-weight: bold;
    }
    .footer {
        margin-top: 30px;
        font-size: 0.9em;
        color: #9ca3af;
    }
    .language-badge {
        background-color: #2563eb;
        color: white;
        padding: 5px 12px;
        border-radius: 15px;
        font-size: 14px;
        display: inline-block;
        margin-left: 15px;
    }
    #selection-msg { margin-top: 8px; color: #a3e635; font-weight: 600; }
</style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1 class="text-3xl font-bold text-blue-400">Cyber Sleuth Challenge <span class="text-white">10/10</span></h1>
        <h2 class="text-xl mt-2">Spot, Suggest, Secure!</h2>
    </div>

    <div class="challenge-content">
        <div class="flex justify-between items-center">
            <h3 class="text-2xl font-semibold text-yellow-400">Identify the Vulnerability</h3>
            <span class="language-badge"><i class="fas fa-code mr-1"></i> Terraform Language</span>
        </div>

       <div class="code-block text-lg">
		  provider "aws" {
			access_key = "AKIA12345"
			secret_key = "abcdsecretkey"
		  }
		</div>
		<h3 class="text-xl font-semibold text-blue-400 mt-8 mb-4">What is the correct way to secure AWS credentials?</h3>

		<div class="options" id="options-container">
		  <div class="option" data-value="A">
			<span class="option-letter">A</span>
			<code>Use environment variables or shared credentials file</code>
		  </div>
		  <div class="option" data-value="B">
			<span class="option-letter">B</span>
			<code>Keep keys in code for automation</code>
		  </div>
		  <div class="option" data-value="C">
			<span class="option-letter">C</span>
			<code>Encrypt them with base64</code>
		  </div>
		  <div class="option" data-value="D">
			<span class="option-letter">D</span>
			<code>Disable secret key validation</code>
		  </div>
		</div>
		<div id="selection-msg" aria-live="polite"></div>
		<div class="mt-8 bg-gray-800 p-4 rounded-lg">
		  <p class="text-gray-300"><i class="fas fa-lightbulb text-yellow-400 mr-2"></i><strong>Recommendation:</strong> Never hardcode AWS credentials. Use environment variables, profiles, or AWS Vault.</p>
		</div>
    </div>

    <div class="footer text-right">
        <button id="next-btn" type="button" class="bg-blue-500 text-white px-4 py-2 rounded-3xl font-bold">Submit</button>
    </div>

    <div class="footer text-left">
        <p>October Cybersecurity Awareness Month</p>
    </div>
	<div id="score" class="mt-8 text-xl font-bold"></div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
  import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCDxtG36Qeyhh1nfRypGPDOdvfQgO9_oIA",
    authDomain: "byte-sized-battle.firebaseapp.com",
    databaseURL: "https://byte-sized-battle-default-rtdb.firebaseio.com/",
    projectId: "byte-sized-battle",
    storageBucket: "byte-sized-battle.firebasestorage.app",
    messagingSenderId: "278675191581",
    appId: "1:278675191581:web:410e9faeebb804295453f4",
    measurementId: "G-6QSQDBHR14"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  document.addEventListener('DOMContentLoaded', () => {

    // ✅ Correct answers for all 10 questions
    const correctAnswers = {
		TF_q1: "A",
		TF_q2: "A",
		TF_q3: "A",
		TF_q4: "A",
		TF_q5: "A",
		TF_q6: "A",
		TF_q7: "A",
		TF_q8: "A",
		TF_q9: "A",
		TF_q10:"A"
	};

    const optionsContainer = document.getElementById('options-container');
    const selectionMsg = document.getElementById('selection-msg');
    const nextBtn = document.getElementById('next-btn');
    const storageKey = 'TF_q10';

    let selectedAnswer = localStorage.getItem(storageKey);

    function applySelection(optionEl, save = true) {
      document.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
      if (!optionEl) return;
      optionEl.classList.add('selected');
      selectedAnswer = optionEl.dataset.value;
      selectionMsg.textContent = `Selected: ${selectedAnswer}`;
      if (save) localStorage.setItem(storageKey, selectedAnswer);
    }

    if (selectedAnswer) {
      const prev = document.querySelector(`.option[data-value="${selectedAnswer}"]`);
      if (prev) applySelection(prev, false);
    }

    optionsContainer.addEventListener('click', (ev) => {
      const opt = ev.target.closest('.option');
      if (opt) applySelection(opt);
    });

    nextBtn.addEventListener('click', async () => {
      if (!selectedAnswer) {
        alert('Please select an answer.');
        return;
      }

      // ✅ Calculate total score
      let score = 0;
      for (let i = 1; i <= 10; i++) {
        const userAnswer = localStorage.getItem('TF_q' + i);
        if (userAnswer === correctAnswers['TF_q' + i]) score++;
      }

      const name = localStorage.getItem('employeeName') || prompt("Enter your name:");
      const email = localStorage.getItem('employeeEmail') || prompt("Enter your email:");

      try {
        await push(ref(db, 'quizScores/'), {
          name, email, score,
          timestamp: Date.now()
        });
        document.getElementById('score').innerText = `✅ Your Score: ${score}/10 submitted successfully!`;
      } catch (err) {
        console.error("❌ Firebase write failed:", err);
        alert("Error submitting score. Please try again later.");
      }
    });
  });
</script>
</body>
</html>