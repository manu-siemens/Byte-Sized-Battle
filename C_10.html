<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Cyber Sleuth Challenge - Q10</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&amp;family=Montserrat:wght@400;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet"/>
<style>
    body {
        background-color: #121212;
        color: #e0e0e0;
        font-family: 'Montserrat', sans-serif;
        margin: 0;
        padding: 0;
        width: 1280px;
        min-height: 720px;
    }
    .container { width: 1280px; min-height: 720px; padding: 40px; box-sizing: border-box; }
    .header { border-bottom: 2px solid #2563eb; padding-bottom: 10px; margin-bottom: 30px; }
    .code-block {
        font-family: 'Roboto Mono', monospace;
        background-color: #1e1e1e;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
        border-left: 4px solid #2563eb;
        color: #e0e0e0;
    }
    .keyword { color: #569cd6; }
    .option {
        background-color: #1e293b;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 15px;
        border-left: 4px solid #3b82f6;
        transition: all 0.18s ease;
        cursor: pointer;
        user-select: none;
    }
    .option:hover { background-color: #2d3748; border-left: 4px solid #60a5fa; }
    .option.selected { background-color: #0f172a; border-left: 4px solid #93c5fd; box-shadow: 0 0 0 4px rgba(59,130,246,0.06) inset; }
    .option-letter {
        display: inline-block;
        width: 30px;
        height: 30px;
        background-color: #3b82f6;
        color: white;
        text-align: center;
        line-height: 30px;
        border-radius: 50%;
        margin-right: 10px;
        font-weight: bold;
    }
    .footer { margin-top: 30px; font-size: 0.9em; color: #9ca3af; }
    .language-badge {
        background-color: #2563eb;
        color: white;
        padding: 5px 12px;
        border-radius: 15px;
        font-size: 14px;
        display: inline-block;
        margin-left: 15px;
    }
    #selection-msg { margin-top: 8px; color: #a3e635; font-weight: 600; }
</style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1 class="text-3xl font-bold text-blue-400">Cyber Sleuth Challenge <span class="text-white">10/10</span></h1>
        <h2 class="text-xl mt-2">Spot, Suggest, Secure!</h2>
    </div>

    <div class="challenge-content">
        <div class="flex justify-between items-center">
            <h3 class="text-2xl font-semibold text-yellow-400">Identify the Vulnerability</h3>
            <span class="language-badge"><i class="fas fa-code mr-1"></i> C Language</span>
        </div>

        <div class="code-block text-lg">
			<span class="keyword">char</span> *p = malloc(50);
			<span class="keyword">strcpy</span>(p, "Hello World");
			<span class="keyword">return</span>;
		</div>
		<h3 class="text-xl font-semibold text-blue-400 mt-8 mb-4">
			Which fix would address the security vulnerability?
		</h3>

		<div class="options" id="options-container">
			<div class="option" data-value="A">
				<span class="option-letter">A</span>
				<code>free(p);</code>
			</div>
			<div class="option" data-value="B">
				<span class="option-letter">B</span>
				<code>p = NULL;</code>
			</div>
			<div class="option" data-value="C">
				<span class="option-letter">C</span>
				<code>delete p;</code>
			</div>
			<div class="option" data-value="D">
				<span class="option-letter">D</span>
				<code>memset(p, 0, 50);</code>
			</div>
		</div>

        <div id="selection-msg" aria-live="polite"></div>

        <div class="mt-8 bg-gray-800 p-4 rounded-lg">
            <p class="text-gray-300"><i class="fas fa-lightbulb text-yellow-400 mr-2"></i><strong>Recommendation:</strong> Free allocated memory before returning to prevent memory leaks.</p>
        </div>
    </div>

    <div class="footer text-right">
        <button id="next-btn" type="button" class="bg-blue-500 text-white px-4 py-2 rounded-3xl font-bold">Submit</button>
    </div>

    <div class="footer text-left">
        <p>October Cybersecurity Awareness Month</p>
    </div>
	<div id="score" class="mt-8 text-xl font-bold"></div>
</div>

<!-- ✅ Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js"></script>

<script>
document.addEventListener('DOMContentLoaded', () => {

	// ✅ Initialize Firebase
	const firebaseConfig = {
	  apiKey: "YOUR_API_KEY",
	  authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
	  databaseURL: "https://YOUR_PROJECT_ID-default-rtdb.firebaseio.com",
	  projectId: "YOUR_PROJECT_ID",
	  storageBucket: "YOUR_PROJECT_ID.appspot.com",
	  messagingSenderId: "YOUR_SENDER_ID",
	  appId: "YOUR_APP_ID"
	};

	const app = firebase.initializeApp(firebaseConfig);
	const db = firebase.database();

	// ✅ Correct answers
	const correctAnswers = {
		c_q1: "A", c_q2: "A", c_q3: "A", c_q4: "A", c_q5: "A",
		c_q6: "A", c_q7: "A", c_q8: "A", c_q9: "A", c_q10:"A"
	};

	const optionsContainer = document.getElementById('options-container');
	const selectionMsg = document.getElementById('selection-msg');
	const nextBtn = document.getElementById('next-btn');
	const storageKey = 'c_q10';
	let selectedAnswer = localStorage.getItem(storageKey);

	function applySelection(optionEl, save = true) {
		document.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
		if (!optionEl) return;
		optionEl.classList.add('selected');
		selectedAnswer = optionEl.dataset.value;
		selectionMsg.textContent = `Selected: ${selectedAnswer}`;
		if (save) localStorage.setItem(storageKey, selectedAnswer);
	}

	optionsContainer.addEventListener('click', ev => {
		const opt = ev.target.closest('.option');
		if (opt) applySelection(opt);
	});

	if (selectedAnswer) {
		const prev = document.querySelector(`.option[data-value="${selectedAnswer}"]`);
		if (prev) applySelection(prev, false);
	}

	nextBtn.addEventListener('click', async () => {
		if (!selectedAnswer) {
			alert('Please select an answer.');
			return;
		}
		localStorage.setItem(storageKey, selectedAnswer);

		let score = 0;
		for (let i = 1; i <= 10; i++) {
			const userAnswer = localStorage.getItem('c_q' + i);
			if (userAnswer === correctAnswers['c_q' + i]) score++;
		}

		const name = localStorage.getItem('quiz_name') || prompt('Enter your name:');
		const email = localStorage.getItem('quiz_email') || prompt('Enter your email:');

		// ✅ Store to Firebase
		try {
			await firebase.database().ref('quizScores/').push({
				name,
				email,
				score,
				timestamp: Date.now()
			});
			alert(`✅ Your score (${score}/10) has been submitted!`);
			document.getElementById('score').innerText = `Your Score: ${score} / 10`;
		} catch (err) {
			console.error('❌ Error submitting to Firebase:', err);
			alert('Failed to submit score. Please retry later.');
		}
	});
});
</script>
</body>
</html>
